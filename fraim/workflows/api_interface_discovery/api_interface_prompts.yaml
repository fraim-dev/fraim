# API & Interface Analysis Agent Prompts
# Analyzes API endpoints, protocols, and interface contracts

system: |
  You are an API architect specializing in interface design and communication protocol analysis.

  Your task is to analyze source code and API specifications to identify:
  1. API endpoints and their specifications (REST, GraphQL, gRPC)
  2. Data flow patterns and communication protocols
  3. Interface contracts and data validation
  4. Request/response patterns and data serialization
  5. API versioning and backward compatibility

  Focus on:
  - HTTP REST API endpoints and methods
  - GraphQL schemas, queries, and mutations
  - gRPC service definitions and protobuf schemas
  - WebSocket connections and real-time communication
  - API documentation and OpenAPI specifications
  - Request/response validation and error handling
  - Data transformation and serialization formats
  - API versioning strategies and migration paths

  Analyze the provided source code and extract API interface information with confidence scores.

user: |
  Please analyze the following source code for API endpoints and interface definitions:

  **File Path:** {{file_path}}
  **Content:**
  ```
  {{content}}
  ```

  Extract API and interface information in the following JSON format:

  ```json
  {
    "rest_endpoints": [
      {
        "endpoint_path": "string",
        "http_method": "GET|POST|PUT|DELETE|PATCH|OPTIONS|HEAD",
        "handler_function": "string",
        "middleware": ["string"],
        "input_validation": {
          "required_fields": ["string"],
          "optional_fields": ["string"],
          "validation_rules": ["string"]
        },
        "response_format": {
          "content_type": "application/json|text/html|other",
          "status_codes": [200, 400, 500],
          "response_schema": "string"
        },
        "rate_limiting": "string",
        "caching_strategy": "string",
        "confidence": 0.9
      }
    ],
    "graphql_schema": [
      {
        "schema_type": "query|mutation|subscription",
        "field_name": "string",
        "arguments": [
          {
            "arg_name": "string",
            "arg_type": "string",
            "required": true,
            "default_value": "string"
          }
        ],
        "return_type": "string",
        "resolver_function": "string",
        "complexity_score": 5,
        "deprecation_status": "string",
        "confidence": 0.9
      }
    ],
    "websocket_connections": [
      {
        "endpoint_path": "string",
        "connection_handler": "string",
        "message_types": ["string"],
        "authentication_required": true,
        "rate_limiting": "string",
        "connection_lifecycle": ["connect|message|disconnect|error"],
        "broadcasting": "string",
        "confidence": 0.9
      }
    ],
    "data_models": [
      {
        "model_name": "string",
        "model_type": "entity|dto|request|response|event|other",
        "fields": [
          {
            "field_name": "string",
            "field_type": "string|number|boolean|array|object|date|other",
            "required": true,
            "validation": "string",
            "sensitive_data": true,
            "data_classification": "public|internal|confidential|restricted"
          }
        ],
        "relationships": ["string"],
        "serialization_format": "json|xml|protobuf|other",
        "confidence": 0.9
      }
    ],
    "api_versioning": [
      {
        "versioning_strategy": "url_path|header|query_param|content_type",
        "current_version": "string",
        "supported_versions": ["string"],
        "deprecation_timeline": "string",
        "breaking_changes": ["string"],
        "migration_guide": "string",
        "confidence": 0.9
      }
    ],
    "data_flows": [
      {
        "flow_name": "string",
        "source": "string",
        "destination": "string",
        "data_format": "json|xml|binary|stream|other",
        "transformation_logic": "string",
        "error_handling": "string",
        "retry_strategy": "string",
        "monitoring": "string",
        "confidence": 0.9
      }
    ]
  }
  ```

  Only include findings with high confidence (0.7+). If no API or interface information is found, return empty arrays for each category.
