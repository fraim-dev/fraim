---
title: "Risk Flagger"
sidebarTitle: "Risk Flagger"
tag: "NEW"
---

# Risk Flagger Workflow

The **Risk Flagger** workflow analyzes code changes for security risks that require security team investigation. Unlike traditional vulnerability scanners, this workflow focuses on identifying changes that could introduce security risks, making it ideal for pull request analysis and change management.

## Overview

- **Workflow ID**: `risk_flagger`
- **Primary Use Case**: Risk assessment of code changes and pull requests
- **Output**: Risk findings and optional GitHub notifications
- **Required Mode**: Must use `--diff` mode

## Common Use Cases

### 1. Pull Request Security Gate

<Tabs>
<Tab title="CLI">
```bash
# Automated PR analysis with team notification
fraim run risk_flagger --location . --diff --base main --head HEAD \
  --pr-url https://github.com/owner/repo/pull/123 \
  --approver security-team \
  --custom-risk-list-json '{"Example Rule": "Flag this rule on every diff, it is an example to show how the workflow works."}' \
  --custom-risk-list-action replace
```
</Tab>
<Tab title="GitHub Actions">
```yaml
name: PR Security Gate
on:
  pull_request:
    branches: [main, develop]

jobs:
  security-gate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
      
      - name: Run Risk Flagger
        uses: fraim-dev/fraim-action@8d763963b80e2551c7ec3f5bdbd77bad6ce7658c
        with:
          anthropic-api-key: ${{ secrets.ANTHROPIC_API_KEY }}
          workflow: risk_flagger
          workflow_args: |
            {
              "approver": "security-team",
              "should-block-pull-request": true,
              "confidence": 7
            }
          github-token: ${{ secrets.GH_TOKEN }}
```
</Tab>
</Tabs>

### 2. Custom Risk Categories

<Tabs>
<Tab title="CLI">
```bash
# Organization-specific risk assessment
fraim run risk_flagger --location . --diff \
  --custom-risk-list-filepath ./org-risks.yaml \
  --custom-false-positive-considerations \
    "Ignore test files in /tests/" \
    "Skip demo applications"
```
</Tab>
<Tab title="GitHub Actions">
```yaml
name: Custom Risk Assessment
on:
  pull_request:
    branches: [main]

jobs:
  custom-risk-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
      
      - name: Custom Risk Analysis
        uses: fraim-dev/fraim-action@8d763963b80e2551c7ec3f5bdbd77bad6ce7658c
        with:
          anthropic-api-key: ${{ secrets.ANTHROPIC_API_KEY }}
          workflow: risk_flagger
          workflow_args: |
            {
              "custom-risk-list-filepath": "./org-risks.yaml",
              "custom-false-positive-considerations": [
                "Ignore test files in /tests/",
                "Skip demo applications"
              ]
            }
          github-token: ${{ secrets.GH_TOKEN }}
```
</Tab>
</Tabs>

### 3. Release Branch Analysis

<Tabs>
<Tab title="CLI">
```bash
# Analyze changes between releases
fraim run risk_flagger --location . --diff \
  --base v1.0.0 \
  --head v1.1.0 \
  --confidence 6
```
</Tab>
<Tab title="GitHub Actions">
```yaml
name: Release Risk Analysis
on:
  push:
    tags: ['v*']

jobs:
  release-analysis:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
      
      - name: Analyze Release Changes
        uses: fraim-dev/fraim-action@8d763963b80e2551c7ec3f5bdbd77bad6ce7658c
        with:
          anthropic-api-key: ${{ secrets.ANTHROPIC_API_KEY }}
          workflow: risk_flagger
          workflow_args: |
            {
              "base": "${{ github.event.before }}",
              "head": "${{ github.sha }}",
              "confidence": 6
            }
```
</Tab>
</Tabs>

### 4. Pre-Commit Risk Assessment

<Tabs>
<Tab title="CLI">
```bash
# Local risk check before committing
fraim run risk_flagger --location . --diff \
  --confidence 8
```
</Tab>
</Tabs>

## Workflow-Specific Options

### Required Options

#### `--diff`
**Required**: The risk flagger workflow must run in diff mode.

```bash
fraim run risk_flagger --location . --diff
```

### GitHub Integration Options

#### `--pr-url <URL>`
URL of the pull request to analyze for GitHub integration.

```bash
fraim run risk_flagger --location . --diff \
  --pr-url https://github.com/owner/repo/pull/123
```

#### `--approver <USERNAME>`
GitHub username or team to notify when risks are found.

```bash
fraim run risk_flagger --location . --diff \
  --pr-url https://github.com/owner/repo/pull/123 \
  --approver security-team
```

#### `--should-block-pull-request <BOOLEAN>` (GitHub Action only)
Whether to block the pull request until security review is complete. Available only when using the GitHub Action.

**Default**: `false`

```yaml
# In GitHub Action workflow_args
"should-block-pull-request": true
```

### Customization Options

#### `--custom-risk-list-action <append|replace>`
How to handle custom risk lists.

**Default**: `append`

```bash
# Add custom risks to default list
fraim run risk_flagger --location . --diff \
  --custom-risk-list-action append

# Replace default risks with custom ones
fraim run risk_flagger --location . --diff \
  --custom-risk-list-action replace
```

#### `--custom-risk-list-filepath <PATH>`
Path to JSON/YAML file containing additional risks.

```bash
fraim run risk_flagger --location . --diff \
  --custom-risk-list-filepath ./custom-risks.yaml
```

**Example custom-risks.yaml:**
```yaml
"API Endpoint Changes": "Changes to API endpoints that handle sensitive data should be reviewed by the security team"
"Payment Processing": "Any changes to payment processing logic require security review"
"User Data Handling": "Modifications to user data processing need privacy team approval"
```

#### `--custom-risk-list-json <JSON>`
JSON string containing additional risks.

```bash
fraim run risk_flagger --location . --diff \
  --custom-risk-list-json '{"Custom Risk": "Description of the risk"}'
```

#### `--custom-false-positive-considerations <LIST>`
Additional considerations to reduce false positives.

```bash
fraim run risk_flagger --location . --diff \
  --custom-false-positive-considerations \
    "Ignore test files" \
    "Consider demo code as low risk" \
    "Skip configuration templates"
```

## GitHub Actions Integration

<Note>
**Prerequisites**: To use the Risk Flagger workflow with GitHub Actions, you need to create a Personal Access Token with the appropriate permissions. This is because the default Github Actions token does not have permissions to create status checks, or to request reviewers. Use the tool below to generate a personalized token creation URL for your repository.
</Note>

import { GitHubTokenGenerator } from "/snippets/github-token-generator.jsx"

<GitHubTokenGenerator />

```yaml
name: Risk Assessment
on:
  pull_request:
    branches: [main]
  pull_request_review:
    types: [submitted]

jobs:
  risk-assessment:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
      
      - name: Run Fraim Risk Flagger Scan
        id: fraim-scan
        uses: fraim-dev/fraim-action@8d763963b80e2551c7ec3f5bdbd77bad6ce7658c
        with:
          workflow: risk_flagger
          workflow_args: |
            {
              "approver": "security",
              "should-block-pull-request": true,
              "custom-risk-list-json": {
                "Example Risk": "Never flag this risk, it is just an example."
              },
              "custom-risk-list-action": "append"
            }
          anthropic-api-key: ${{ secrets.ANTHROPIC_API_KEY }}
          github-token: ${{ secrets.GH_TOKEN }}
```

#### Available workflow_args

| Argument | Type | Default | Description |
|----------|------|---------|-------------|
| `confidence` | integer (1-10) | `7` | Minimum confidence threshold for filtering findings |
| `chunk-size` | integer | `500` | Number of lines per chunk |
| `limit` | integer | `null` | Limit the number of files to scan |
| `globs` | array of strings | `null` | File patterns to include (uses workflow defaults if not provided) |
| `max-concurrent-chunks` | integer | `5` | Maximum number of chunks to process concurrently |
| `approver` | string | `""` | GitHub username or group to notify for approval |
| `should-block-pull-request` | boolean | `false` | Whether to block the pull request until security review is complete |
| `custom-risk-list-action` | string | `"append"` | Whether to `"append"` to or `"replace"` the default risks list |
| `custom-risk-list-filepath` | string | `null` | Path to JSON/YAML file containing additional risks |
| `custom-risk-list-json` | object | `null` | JSON object containing additional risks to consider |
| `custom-false-positive-considerations` | array of strings | `[]` | List of additional considerations to help reduce false positives |
